# 概述
- 一个事务从开始到执行会经历三个阶段
	- 开始事务
	- 命令入队
	- 执行事务
- `Redis`事务可以一次性执行多个命令，且有以下三个保证
	- 批量操作在发送`EXEC`命令前被放入队伍缓存
	- 收到`EXEC`命令后进入事务执行，事务中任意命令执行失败，其余的命令依然被执行
		- 命令打错的这种，会导致所有命令都不会执行
		- 命令没错，执行过程中失败，其他命令会被执行
	- 事务执行过程中，其他客户端提交的命令请求不会被插入到事务执行命令序列中
- 单个`Redis`命令的执行时原子性上，但是事务的执行不是原子性的。可以将`Redis`的事务理解为批处理命令。

# 实例
```
MULTI    #开始一个事务

一些命令

EXEC     # 触发事务
DISCARD  # 取消事务

```

# Redis实现乐观锁
- 悲观锁，什么操作都会进行加锁
- 乐观锁：不会上锁，更新数据的时候去判断在此期间是否有人修改这个数据。

## Redis监视实现乐观锁
- 被`watch`的值，在执行事务时，如果此时有其他人修改了对应的值，该事务会执行失败
- 事务执行失败，需要先解锁`unwatch`，再重新加锁`watch`，获取新值
```
watch key    #监视一个键对应的值
```
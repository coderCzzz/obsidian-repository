## 1.0.x版本之前
### 概述
- `Master Thread`具有最高的线程优先级，内部有多个循环（loop）组成：主循环、后台循环、刷新循环、暂停循环
- `Master Thread`根据数据库运行状态在循环之间切换

### Loop主循环
- 主要包含两大操作
	- 每秒操作
	- 每10秒操作

#### 每秒操作
- 重做日志缓冲刷新到磁盘，即使这个事务还没有提交--总是
- 合并插入缓冲--可能
	- 一秒内的IO是否小于5次，小于才操作
- 至多刷新100个脏页到磁盘--可能
	- 判断当前脏页比例是否查过了配置文件中参数配置
- 当前没有用户活动，切换到后台循环--可能

#### 每10秒操作
- 刷新100个脏页到磁盘-可能
	- 判断10秒内IO操作是否小于200
- 合并至多5个插入缓冲--总是
- 将重做日志缓冲刷新到磁盘--总是
- 删除无用的undo页--总是
- 刷新100或10个脏页到磁盘--总是
	- 脏页比例超过70%刷100，小于70%刷10%脏页

### background loop后台循环
- 删除无用的undo页--总是
- 合并20个插入缓冲--总是
- 调回到主循环--总是
- 不断刷新100个页直到符合条件--可能跳转到刷新循环执行

### 刷新循环
- 不断刷新100个页直到符合条件

### suspend loop暂停循环
- 将`Master Thread`挂起

## 1.2.x之前
- 之前的使用硬编码，如刷新100个脏页。
- 优化
	- 对于刷盘的速度，会根据`innodb_io_capacity`来控制
		- 合并插入缓冲，合并的数量为`innodb_io_capacity`的5%
		- 刷新脏页数量为`innodb_io_capacity`
	- 将脏页比例从90%改为75%
	- `innodb_adaptive_flushing`自适应刷新
	- 从之前的只能合并20个插入缓冲到可以设置`innodb_purge_batch_size`

## 1.2.x之后
- 对于刷脏页的操作，从`Master Thread`线程分离到单独的`Page Cleaner Thread`